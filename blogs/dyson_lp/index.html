<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>Virie's weblog</title><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=icon type=image/svg+xml href=../../resources/Virie_symbol_2023.svg><link rel=stylesheet href=../../styles/effect.css><link rel=stylesheet href=../../styles/banner.css><link rel=stylesheet href=../../styles/theme.css><link rel=stylesheet href=../styles/layout.css><link rel=stylesheet href=../styles/theme.css><link rel=stylesheet href=./styles.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0"></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-45PD6BDYNZ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-45PD6BDYNZ');
</script><body class=neutral-2><div class="banner active secondary"><div class=title><h1 id=virie-header class=relief></h1></div><div class="menu relief"><a href=../../index.html>home</a><a href=../../weblogs.html>weblogs</a><a href=../../profile.html>profile</a><a href=../../persona.html>persona</a></div></div><div class="navigate tertiary silver-lining-bottom"><a href=../mathrope/index.html>prev</a><a href=../../weblogs.html class=date>August 8th, 2023</a><a href=../arbitrary_ode/index.html>next</a></div><div class="blog primary"><div class=content><h1>&#8747 Linear programming calculator for Dyson sphere program</h1><hr><div class=kernel><h2> Kernel: </h2><ul><li> Derive the optimal conditions for Dyson sphere program. </li><li> A web-assembly-based linear programming calculator. </li></ul></div><p class=first> In Dyson sphere program<span class=cite>https://store.steampowered.com/app/1366540/Dyson_Sphere_Program</span>, you are set to design and build dyson spheres, theoretical structures that allow the builder to harnest virtually limitless energy of a star<span class=cite>https://en.wikipedia.org/wiki/Dyson_sphere</span>. You are not going to put structures piece by piece however. Instead, you are going to design a planetary factory that spans across systems to automate the process of building dyson spheres. If you have a knack for factory management games like me, the word interesting for this game is an gross understatement. </p><img src="https://steamuserimages-a.akamaihd.net/ugc/5069395935054288776/B9F8AD4615D548E13F2827228BD0D1F7D97EF58C/?imw=5000&imh=5000&ima=fit&impolicy=Letterbox&imcolor=%23000000&letterbox=false" alt="My dyson sphere design"> My own unique design only with the frame.<span class=cite>https://steamcommunity.com/sharedfiles/filedetails/?id=2910743746</span><p> There's a mathematical puzzle to solve in this and any other factory management games. <i>How do you optimize the production of a certain product?</i> By optimize, I mean finding the optimal ratio of the factories that produce the each of the intermediate product, So that I can produce the final product with the least amount of resources and time. </p><h2>&#8706 Dynamic programming approach</h2><p class=first> Here's the setting. There are many products that you can produce. For each product, there can be more than one process that can produce it. And for each process, it takes a certain amount of time to produce the product, but it can produce more than one product at a time. The processes can also require other products with different amount as the input components. </p><ul><li> Let \(n_p\) be the number of product per tick crafted by the process p. </li><li> Let \(t_p\) be the time for the process p to craft. </li><li> Let \(r\) be the required rate of the product. </li></ul> The required number of the factories for that process is therefore given by \(\frac{t_p}{r n_p} = F_p(r)\). Let \( K_a(r) \) the minimal cost of crafting product \( a \) at rate \(r\). Bellman's equation<span class=cite>Kirk, D. E. (2004). Optimal control theory: an introduction. Courier Corporation.</span> for this problem is as follows: <div class=mathjax> \[ K_a(r) = \min_{p \in P_a} F_p(r) \sum_{c \in C_p} K_c\left(\frac{m_{p, c}}{t_p}\right) \] </div><ul><li>\(P_a\) is the set of processes that make a.</li><li>\(C_p\) is the component list of the process p.</li><li>\(m_{p, c}\) is the number of component c required by the process p.</li><li>Suppose that all mining operations are automated and has the base cost of 1.</li></ul><p> Unrolling the recursion, this Bellman's equation can be solved by dynamic programming at \(O(|C|^2|P|)\), where \(|P|\) is the total number of the processes, and \(|C|\) is the total number of the products. Although this problem is polynomial on the dimension of the input, I'm interested to see whether I can use mathematical programming to solve this problem instead. </p><h2>&#8706 Mathematical programming approach</h2><p class=first> Using mathematical programming requires that we think about how to approach the problem in a different way. If you're trying to solve the dynamic programming, you must think about how to break down the problem into smaller subproblems, i.e. you're designing the process of solving by yourself. However when you're using mathematical programming, you're telling the computer what are the conditions for the solution and let it do the search for you. </p> Here in our case, <ul><li>Let \(\vec{l}\) be the cost vector associated with each process. (Which is assumed to be the all-one vector.)</li><li>Let \(\vec{f}\) be the vector of factory count for each process.</li><li>Let \(\vec{r}\) be the vector of resource production rate.</li><li>Let \(\vec{v}\) be the eligible vector associated with each process. (Allow or not allow this process.)</li><li>Let \(D\) be the matrix of net production rate for each product x process. (If it's negative instead of positive, that process consumes that product rather than producing it.) </li></ul><p> We can formulate the problem as a linear programming problem. The goal is to minimize the number of factories, with nothing fewer than zero. The total production rate of each product must also be non-negative and equal to the net production rate given the number of factories: </p><div class="math-program mathjax"> Minimize: \[ \vec{l}^\intercal.\vec{f} \] Subject to: \[ \begin{align} 0 &\leq \vec{f} \\ 0 &\leq \vec{r} \\ \vec{f}^\intercal.\vec{v} &= 0 \\ D.\vec{f} &= \vec{r} \\ \end{align} \] </div> With every theoretical aspect sorted out, I have made a prototype calculator using the web assembly technology<span class=cite>https://webassembly.org</span> via HiGHs.js<span class=cite>https://github.com/lovasoa/highs-js</span>. Interact with the calculator below to try it out. <div id=product-speed class="control kernel suggest-tag"><div class="header tertiary"><label>Find product to craft</label><input type=search class=widget-search-input></div><div class="body primary"><div class="widget-tag-list list"></div><div class="widget-tag-suggest list"></div></div></div><div id=process-disabled class="control kernel suggest-tag"><div class="header tertiary"><label>Find process to ban</label><input type=search class=widget-search-input></div><div class="body primary"><div class="widget-tag-list list"></div><div class="widget-tag-suggest list"></div></div></div><div class="control kernel"><div class="header tertiary"><div id=calculate-button class=button><span class=material-symbols-outlined>calculate</span><label>Calculate</label></div></div><div id=result class="body list"></div></div><hr><ul class=bibliography></ul></div></div><script src=../../libs/svg.min.js></script><script src=../scripts/bibliography.js></script><script src=../../scripts/viewer.js></script><script src=../../scripts/active.js></script><script src=./src/suggest_list.js></script><script src=./thirdparties/highs.js></script><script src=./src/optimal_process.js></script><script src=./src/main.js></script><script src=../scripts/weblog.js></script></body></html>